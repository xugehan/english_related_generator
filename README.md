# 学生成绩小分条生成器

这是一个用于生成学生成绩小分条PDF的工具，提供命令行和图形界面两种使用方式。

## 安装依赖

```bash
pip install pandas reportlab openpyxl streamlit
```

## 使用方法

### 方法1: 图形界面（推荐）✨

1. 启动Streamlit应用：
```bash
streamlit run app.py
```
或者使用启动脚本：
```bash
./start_gui.sh
```

2. 在浏览器中打开自动弹出的页面（通常是 http://localhost:8501）

3. 按照页面提示操作：
   - **左侧边栏**：
     * **下载模板**：点击"⬇️ 下载Excel模板"（含3行示例数据）
       - ⭐ **必须保持**："姓名"、"学号"、"班级"三列
       - ✏️ **可以修改**：其他成绩列可自由添加、删除或重命名
     * **上传Excel**：点击"Browse files"上传Excel文件（包含学生成绩数据）
     * **上传字体**（可选）：点击"Browse files"上传中文字体文件（如simsun.ttc）
       - 如果不上传字体，将使用系统默认字体Helvetica（可能无法显示中文）
   
   - **主界面**：
     * **预览数据**：查看Excel数据的前10行
     * **选择列**：勾选需要在PDF中显示的成绩项目（默认全选）
       - 姓名、学号、班级会自动显示
       - 其他成绩列可以自由选择
     * **调整参数**：
       - 文档标题（默认：学生成绩小分条）
       - 卡片标题（默认：期中英语，显示在右上角）
       - 页面方向（横向/纵向）
       - 布局设置（每行卡片数：默认2，每页行数：默认4）
       - 卡片高度、页面边距、卡片间距
       - 字体大小（人名字号：默认10，卡片标题字号：默认8，正文字号：默认8）
   
   - 点击"🎨 生成PDF"按钮
   - 点击"⬇️ 下载PDF文件"按钮保存文件

**注意事项**：
- ✅ 文件上传器会显示"Browse files"按钮，点击即可选择文件
- ✅ 如果不上传字体文件，系统会自动使用Helvetica字体（仅支持英文）
- ✅ 建议上传中文字体文件（如simsun.ttc）以正确显示中文
- ✅ 所有参数都有合理的默认值，可以直接使用

### 方法2: 命令行

```bash
python student_grades_generator.py \
  --excel 学生成绩.xlsx \
  --pdf output.pdf \
  --font simsun.ttc \
  --title "学生成绩小分条" \
  --card_title "期中英语" \
  --cols 2 \
  --rows 4 \
  --card_h 140 \
  --title_font_size 10 \
  --card_title_font_size 8 \
  --body_font_size 8
```

### 命令行参数说明

- `--excel`: Excel文件路径（必需）
- `--pdf`: 输出PDF文件路径（必需）
- `--font`: 中文字体文件路径（可选）
- `--title`: 文档标题（默认：学生成绩小分条）
- `--card_title`: 卡片右上角标题（默认：期中英语）
- `--cols`: 每行卡片数（默认：2）
- `--rows`: 每页行数（默认：4）
- `--portrait`: 使用纵向布局（默认：横向）
- `--card_h`: 卡片高度，单位点（默认：140）
- `--margin`: 页面边距，单位点（默认：36）
- `--gutter`: 卡片间距，单位点（默认：16）
- `--title_font_size`: 人名/学号字号（默认：10）
- `--card_title_font_size`: 卡片标题字号（默认：8）
- `--body_font_size`: 正文字号（默认：8）

## Excel文件格式要求

Excel文件应包含以下列：
- **姓名** 或 **姓名/Name** 或 **Name**
- **学号** 或 **学号/Code** 或 **Code**
- **班级** 或 **班级/Class** 或 **Class**
- 其他成绩列（如：听写、默写、作业等）

示例：

| 姓名 | 学号 | 班级 | 听写 | 默写 | 作业 | 总分 |
|------|------|------|------|------|------|------|
| 张三 | 001  | 一班 | 95   | 90   | 88   | 273  |
| 李四 | 002  | 一班 | 88   | 92   | 90   | 270  |

## 特点

- ✅ 提供标准Excel模板下载
- ✅ 支持自定义选择显示的成绩列
- ✅ 支持 .xlsx 和 .xls 两种Excel格式
- ✅ 支持自定义布局（列数、行数、间距）
- ✅ 支持自定义字体和字号
- ✅ 自动分页
- ✅ 美观的卡片设计（圆角、阴影）
- ✅ 可配置的卡片标题（右上角显示）
- ✅ 图形界面操作简单直观
- ✅ 实时预览数据


